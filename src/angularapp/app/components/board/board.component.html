<div *ngIf="board" class="board">
    <div class="header">
        <div class="board_name">
            <h1 class="board_name">
                <a href="{{board.local_url}}" title="View board {{board.name}} details">{{board.name}}</a>
            </h1>
        </div>
        <div class="members" *ngIf="members">
            <span class="members_header">
                <h2>Members ({{board.members.length}})</h2>
                <span class="btn btn-primary" (click)="showAddMemberForm=true" title="Show add member form for board {{board.name}}">
                    <span class="fa fa-plus"></span>
                    Member
                </span>
            </span>
            <div *ngIf="showAddMemberForm" class="add_member">
                <form (ngSubmit)="onAddMemberSubmit(addMemberForm.value.member)" #addMemberForm="ngForm">
                    <select name="member" required ngModel>
                        <option *ngFor="let member of members" value="{{member.id}}">{{member.extern_username}}</option>
                    </select>
                    <div>
                        <span class="btn btn-danger" (click)="showAddMemberForm=false">Cancel</span>
                        <button type="submit" class="btn btn-success change_name" title="Add new member to board {{board.name}}"
                                [disabled]="!addMemberForm.valid">
                            Add member
                        </button>
                    </div>
                </form>
            </div>
            <div *ngFor="let member of board.members">
                <span class="member">
                    <span class="member_name">{{member.extern_username}}</span>
                    <span *ngIf="!member.is_current_user" class="btn btn-primary" (click)="removeMember(member)"><span class="fa fa-ban"></span></span>
                    <span *ngIf="member.is_current_user">(You)</span>
                </span>
            </div>
        </div>
    </div>
    <div class="lists" [dragula]='"lists"' [dragulaModel]='list' [style.width.px]="board.lists.length * 420 + 80">
        <div *ngFor="let list of board.lists" class="list panel panel-default" [attr.data-list]="list.id">
            <div class="list_name panel-heading cursor-pointer">
                <div class="list_name">
                    <span class="list_name_name">
                        <span>{{list.name}}</span> ({{list.cards.length}} tasks)
                    </span>
                    <span (click)="showNewCardForm[list.id] = true" class="btn btn-primary list_name_new_card" title="New card in list {{list.name}}">
                        <span class="fa fa-plus"></span> Card
                    </span>
                    <span class="move_list_handle">
                        <span class="fa fa-arrows"></span>
                    </span>
                </div>
                <div *ngIf="showNewCardForm[list.id]" class="list_new_card">
                    <form (ngSubmit)="onNewCardSubmit(list, newCardForm.value.name, newCardForm.value.position)" #newCardForm="ngForm">
                    <textarea name="name" class=card_name-edit placeholder="Title of your new card" required ngModel></textarea>
                    <select name="position" required ngModel>
                        <option value="top">Top</option>
                        <option value="bottom">Bottom</option>
                    </select>
                    <div>
                        <span class="btn btn-danger" (click)="showNewCardForm[list.id] = false">Cancel</span>
                        <button type="submit" class="btn btn-success change_name" title="Create new card on list {{list.name}}"
                                [disabled]="!newCardForm.valid">
                            Create
                        </button>
                    </div>
                    </form>
                </div>
            </div>
            <div [dragula]='"cards"' [dragulaModel]='list.cards'
                    id="card-list-{{list.id}}" class="cards" [attr.data-list]="list.id">
                <div *ngFor="let card of list.cards"
                        id="card-{{card.id}}" class="card panel panel-info" [attr.data-card]="card.id">
                    <span class="panel-heading card_heading">
                        <span (click)="onCardSelect(card)" class="card_name">
                            <span class=card_name-name>{{card.name}}</span>
                        </span>
                        <a href="{{card.short_url}}" title="View card" class="card_action_view">
                            <span class="fa fa-trello"></span>
                        </a>
                        <a href="{{card.url}}" title="View card" class="card_action_view">
                            <span class="fa fa-eye"></span>
                        </a>
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>